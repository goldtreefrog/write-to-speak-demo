language:         node_js
node_js:
  - "8"
cache:
  directories:
    - node_modules
script:
  - npm test TZ=America/Los_Angeles
env:
  - CI=true

before_deploy:
  - npm install netlify-cli -g
  - npm run build

deploy:
  provider:       script
  script:         netlify deploy -p ./build -t $NETLIFY_ACCESS_TOKEN -s $NETLIFY_SITE_ID
  skip_cleanup:   true
  on:
    branch:       master
